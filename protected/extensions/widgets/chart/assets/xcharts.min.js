/*!
xCharts v0.1.3 Copyright (c) 2012, tenXer, Inc. All Rights Reserved.
@license MIT license. http://github.com/tenXer/xcharts for details
*/
(function(){var l,n={},o={},q={};(function(){var ak=this,ae=ak._,ag={},au=Array.prototype,ad=Object.prototype,ap=Function.prototype,ay=au.push,aj=au.slice,aw=au.concat,am=ad.toString,at=ad.hasOwnProperty,af=au.forEach,ai=au.map,ac=au.reduce,aq=au.reduceRight,ar=au.filter,av=au.every,al=au.some,Z=au.indexOf,ax=au.lastIndexOf,aa=Array.isArray,az=Object.keys,ao=ap.bind,ab=function(t){return t instanceof ab?t:this instanceof ab?(this._wrapped=t,void 0):new ab(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=ab),exports._=ab):ak._=ab,ab.VERSION="1.4.3";var X=ab.each=ab.forEach=function(A,y,z){if(null!=A){if(af&&A.forEach===af){A.forEach(y,z)}else{if(A.length===+A.length){for(var w=0,x=A.length;x>w;w++){if(y.call(z,A[w],w,A)===ag){return}}}else{for(var v in A){if(ab.has(A,v)&&y.call(z,A[v],v,A)===ag){return}}}}}};ab.map=ab.collect=function(x,u,v){var w=[];return null==x?w:ai&&x.map===ai?x.map(u,v):(X(x,function(z,t,y){w[w.length]=u.call(v,z,t,y)}),w)};var J="Reduce of empty array with no initial value";ab.reduce=ab.foldl=ab.inject=function(z,w,x,y){var v=arguments.length>2;if(null==z&&(z=[]),ac&&z.reduce===ac){return y&&(w=ab.bind(w,y)),v?z.reduce(w,x):z.reduce(w)}if(X(z,function(A,u,t){v?x=w.call(y,x,A,u,t):(x=A,v=!0)}),!v){throw new TypeError(J)}return x},ab.reduceRight=ab.foldr=function(B,y,z,A){var w=arguments.length>2;if(null==B&&(B=[]),aq&&B.reduceRight===aq){return A&&(y=ab.bind(y,A)),w?B.reduceRight(y,z):B.reduceRight(y)}var x=B.length;if(x!==+x){var v=ab.keys(B);x=v.length}if(X(B,function(u,D,t){D=v?v[--x]:--x,w?z=y.call(A,z,B[D],D,t):(z=B[D],w=!0)}),!w){throw new TypeError(J)}return z},ab.find=ab.detect=function(x,u,v){var w;return U(x,function(z,t,y){return u.call(v,z,t,y)?(w=z,!0):void 0}),w},ab.filter=ab.select=function(x,u,v){var w=[];return null==x?w:ar&&x.filter===ar?x.filter(u,v):(X(x,function(z,t,y){u.call(v,z,t,y)&&(w[w.length]=z)}),w)},ab.reject=function(w,u,v){return ab.filter(w,function(y,x,t){return !u.call(v,y,x,t)},v)},ab.every=ab.all=function(y,w,x){w||(w=ab.identity);var v=!0;return null==y?v:av&&y.every===av?y.every(w,x):(X(y,function(z,u,t){return(v=v&&w.call(x,z,u,t))?void 0:ag}),!!v)};var U=ab.some=ab.any=function(y,w,x){w||(w=ab.identity);var v=!1;return null==y?v:al&&y.some===al?y.some(w,x):(X(y,function(z,u,t){return v||(v=w.call(x,z,u,t))?ag:void 0}),!!v)};ab.contains=ab.include=function(v,u){return null==v?!1:Z&&v.indexOf===Z?-1!=v.indexOf(u):U(v,function(t){return t===u})},ab.invoke=function(w,u){var v=aj.call(arguments,2);return ab.map(w,function(t){return(ab.isFunction(u)?u:t[u]).apply(t,v)})},ab.pluck=function(v,u){return ab.map(v,function(t){return t[u]})},ab.where=function(v,u){return ab.isEmpty(u)?[]:ab.filter(v,function(w){for(var t in u){if(u[t]!==w[t]){return !1}}return !0})},ab.max=function(x,u,v){if(!u&&ab.isArray(x)&&x[0]===+x[0]&&65535>x.length){return Math.max.apply(Math,x)}if(!u&&ab.isEmpty(x)){return -1/0}var w={computed:-1/0,value:-1/0};return X(x,function(A,y,z){var t=u?u.call(v,A,y,z):A;t>=w.computed&&(w={value:A,computed:t})}),w.value},ab.min=function(x,u,v){if(!u&&ab.isArray(x)&&x[0]===+x[0]&&65535>x.length){return Math.min.apply(Math,x)}if(!u&&ab.isEmpty(x)){return 1/0}var w={computed:1/0,value:1/0};return X(x,function(A,y,z){var t=u?u.call(v,A,y,z):A;w.computed>t&&(w={value:A,computed:t})}),w.value},ab.shuffle=function(x){var u,v=0,w=[];return X(x,function(t){u=ab.random(v++),w[v-1]=w[u],w[u]=t}),w};var Q=function(t){return ab.isFunction(t)?t:function(u){return u[t]}};ab.sortBy=function(x,u,v){var w=Q(u);return ab.pluck(ab.map(x,function(A,z,y){return{value:A,index:z,criteria:w.call(v,A,z,y)}}).sort(function(B,y){var z=B.criteria,A=y.criteria;if(z!==A){if(z>A||void 0===z){return 1}if(A>z||void 0===A){return -1}}return B.index<y.index?-1:1}),"value")};var an=function(A,x,y,z){var v={},w=Q(x||ab.identity);return X(A,function(B,u){var D=w.call(y,B,u,A);z(v,D,B)}),v};ab.groupBy=function(w,u,v){return an(w,u,v,function(z,x,y){(ab.has(z,x)?z[x]:z[x]=[]).push(y)})},ab.countBy=function(w,u,v){return an(w,u,v,function(y,x){ab.has(y,x)||(y[x]=0),y[x]++})},ab.sortedIndex=function(D,y,z,A){z=null==z?ab.identity:Q(z);for(var w=z.call(A,y),x=0,v=D.length;v>x;){var B=x+v>>>1;w>z.call(A,D[B])?x=B+1:v=B}return x},ab.toArray=function(t){return t?ab.isArray(t)?aj.call(t):t.length===+t.length?ab.map(t,ab.identity):ab.values(t):[]},ab.size=function(t){return null==t?0:t.length===+t.length?t.length:ab.keys(t).length},ab.first=ab.head=ab.take=function(w,u,v){return null==w?void 0:null==u||v?w[0]:aj.call(w,0,u)},ab.initial=function(w,u,v){return aj.call(w,0,w.length-(null==u||v?1:u))},ab.last=function(w,u,v){return null==w?void 0:null==u||v?w[w.length-1]:aj.call(w,Math.max(w.length-u,0))},ab.rest=ab.tail=ab.drop=function(w,u,v){return aj.call(w,null==u||v?1:u)},ab.compact=function(t){return ab.filter(t,ab.identity)};var H=function(w,u,v){return X(w,function(t){ab.isArray(t)?u?ay.apply(v,t):H(t,u,v):v.push(t)}),v};ab.flatten=function(v,u){return H(v,u,[])},ab.without=function(t){return ab.difference(t,aj.call(arguments,1))},ab.uniq=ab.unique=function(B,y,z,A){ab.isFunction(y)&&(A=z,z=y,y=!1);var w=z?ab.map(B,z,A):B,x=[],v=[];return X(w,function(t,u){(y?u&&v[v.length-1]===t:ab.contains(v,t))||(v.push(t),x.push(B[u]))}),x},ab.union=function(){return ab.uniq(aw.apply(au,arguments))},ab.intersection=function(v){var u=aj.call(arguments,1);return ab.filter(ab.uniq(v),function(t){return ab.every(u,function(w){return ab.indexOf(w,t)>=0})})},ab.difference=function(v){var u=aw.apply(au,aj.call(arguments,1));return ab.filter(v,function(t){return !ab.contains(u,t)})},ab.zip=function(){for(var x=aj.call(arguments),u=ab.max(ab.pluck(x,"length")),v=Array(u),w=0;u>w;w++){v[w]=ab.pluck(x,""+w)}return v},ab.object=function(z,w){if(null==z){return{}}for(var x={},y=0,v=z.length;v>y;y++){w?x[z[y]]=w[y]:x[z[y][0]]=z[y][1]}return x},ab.indexOf=function(z,w,x){if(null==z){return -1}var y=0,v=z.length;if(x){if("number"!=typeof x){return y=ab.sortedIndex(z,w),z[y]===w?y:-1}y=0>x?Math.max(0,v+x):x}if(Z&&z.indexOf===Z){return z.indexOf(w,x)}for(;v>y;y++){if(z[y]===w){return y}}return -1},ab.lastIndexOf=function(z,w,x){if(null==z){return -1}var y=null!=x;if(ax&&z.lastIndexOf===ax){return y?z.lastIndexOf(w,x):z.lastIndexOf(w)}for(var v=y?x:z.length;v--;){if(z[v]===w){return v}}return -1},ab.range=function(A,x,y){1>=arguments.length&&(x=A||0,A=0),y=arguments[2]||1;for(var z=Math.max(Math.ceil((x-A)/y),0),v=0,w=Array(z);z>v;){w[v++]=A,A+=y}return w};var P=function(){};ab.bind=function(x,u){var v,w;if(x.bind===ao&&ao){return ao.apply(x,aj.call(arguments,1))}if(!ab.isFunction(x)){throw new TypeError}return v=aj.call(arguments,2),w=function(){if(!(this instanceof w)){return x.apply(u,v.concat(aj.call(arguments)))}P.prototype=x.prototype;var t=new P;P.prototype=null;var y=x.apply(t,v.concat(aj.call(arguments)));return Object(y)===y?y:t}},ab.bindAll=function(v){var u=aj.call(arguments,1);return 0==u.length&&(u=ab.functions(v)),X(u,function(w){v[w]=ab.bind(v[w],v)}),v},ab.memoize=function(w,u){var v={};return u||(u=ab.identity),function(){var t=u.apply(this,arguments);return ab.has(v,t)?v[t]:v[t]=w.apply(this,arguments)}},ab.delay=function(w,u){var v=aj.call(arguments,2);return setTimeout(function(){return w.apply(null,v)},u)},ab.defer=function(t){return ab.delay.apply(ab,[t,1].concat(aj.call(arguments,1)))},ab.throttle=function(D,y){var z,A,w,x,v=0,B=function(){v=new Date,w=null,x=D.apply(z,A)};return function(){var u=new Date,t=y-(u-v);return z=this,A=arguments,0>=t?(clearTimeout(w),w=null,v=u,x=D.apply(z,A)):w||(w=setTimeout(B,t)),x}},ab.debounce=function(z,w,x){var y,v;return function(){var u=this,t=arguments,A=function(){y=null,x||(v=z.apply(u,t))},B=x&&!y;return clearTimeout(y),y=setTimeout(A,w),B&&(v=z.apply(u,t)),v}},ab.once=function(w){var u,v=!1;return function(){return v?u:(v=!0,u=w.apply(this,arguments),w=null,u)}},ab.wrap=function(v,u){return function(){var t=[v];return ay.apply(t,arguments),u.apply(this,t)}},ab.compose=function(){var t=arguments;return function(){for(var u=arguments,v=t.length-1;v>=0;v--){u=[t[v].apply(this,u)]}return u[0]}},ab.after=function(v,u){return 0>=v?u():function(){return 1>--v?u.apply(this,arguments):void 0}},ab.keys=az||function(w){if(w!==Object(w)){throw new TypeError("Invalid object")}var u=[];for(var v in w){ab.has(w,v)&&(u[u.length]=v)}return u},ab.values=function(w){var u=[];for(var v in w){ab.has(w,v)&&u.push(w[v])}return u},ab.pairs=function(w){var u=[];for(var v in w){ab.has(w,v)&&u.push([v,w[v]])}return u},ab.invert=function(w){var u={};for(var v in w){ab.has(w,v)&&(u[w[v]]=v)}return u},ab.functions=ab.methods=function(w){var u=[];for(var v in w){ab.isFunction(w[v])&&u.push(v)}return u.sort()},ab.extend=function(t){return X(aj.call(arguments,1),function(u){if(u){for(var v in u){t[v]=u[v]}}}),t},ab.pick=function(w){var u={},v=aw.apply(au,aj.call(arguments,1));return X(v,function(t){t in w&&(u[t]=w[t])}),u},ab.omit=function(y){var w={},x=aw.apply(au,aj.call(arguments,1));for(var v in y){ab.contains(x,v)||(w[v]=y[v])}return w},ab.defaults=function(t){return X(aj.call(arguments,1),function(u){if(u){for(var v in u){null==t[v]&&(t[v]=u[v])}}}),t},ab.clone=function(t){return ab.isObject(t)?ab.isArray(t)?t.slice():ab.extend({},t):t},ab.tap=function(v,u){return u(v),v};var G=function(x,F,v,A){if(x===F){return 0!==x||1/x==1/F}if(null==x||null==F){return x===F}x instanceof ab&&(x=x._wrapped),F instanceof ab&&(F=F._wrapped);var E=am.call(x);if(E!=am.call(F)){return !1}switch(E){case"[object String]":return x==F+"";case"[object Number]":return x!=+x?F!=+F:0==x?1/x==1/F:x==+F;case"[object Date]":case"[object Boolean]":return +x==+F;case"[object RegExp]":return x.source==F.source&&x.global==F.global&&x.multiline==F.multiline&&x.ignoreCase==F.ignoreCase}if("object"!=typeof x||"object"!=typeof F){return !1}for(var y=v.length;y--;){if(v[y]==x){return A[y]==F}}v.push(x),A.push(F);var D=0,w=!0;if("[object Array]"==E){if(D=x.length,w=D==F.length){for(;D--&&(w=G(x[D],F[D],v,A));){}}}else{var B=x.constructor,z=F.constructor;if(B!==z&&!(ab.isFunction(B)&&B instanceof B&&ab.isFunction(z)&&z instanceof z)){return !1}for(var I in x){if(ab.has(x,I)&&(D++,!(w=ab.has(F,I)&&G(x[I],F[I],v,A)))){break}}if(w){for(I in F){if(ab.has(F,I)&&!D--){break}}w=!D}}return v.pop(),A.pop(),w};ab.isEqual=function(v,u){return G(v,u,[],[])},ab.isEmpty=function(v){if(null==v){return !0}if(ab.isArray(v)||ab.isString(v)){return 0===v.length}for(var u in v){if(ab.has(v,u)){return !1}}return !0},ab.isElement=function(t){return !(!t||1!==t.nodeType)},ab.isArray=aa||function(t){return"[object Array]"==am.call(t)},ab.isObject=function(t){return t===Object(t)},X(["Arguments","Function","String","Number","Date","RegExp"],function(t){ab["is"+t]=function(u){return am.call(u)=="[object "+t+"]"}}),ab.isArguments(arguments)||(ab.isArguments=function(t){return !(!t||!ab.has(t,"callee"))}),ab.isFunction=function(t){return"function"==typeof t},ab.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},ab.isNaN=function(t){return ab.isNumber(t)&&t!=+t},ab.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==am.call(t)},ab.isNull=function(t){return null===t},ab.isUndefined=function(t){return void 0===t},ab.has=function(v,u){return at.call(v,u)},ab.noConflict=function(){return ak._=ae,this},ab.identity=function(t){return t},ab.times=function(z,w,x){for(var y=Array(z),v=0;z>v;v++){y[v]=w.call(x,v)}return y},ab.random=function(v,u){return null==u&&(u=v,v=0),v+(0|Math.random()*(u-v+1))};var C={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};C.unescape=ab.invert(C.escape);var L={escape:RegExp("["+ab.keys(C.escape).join("")+"]","g"),unescape:RegExp("("+ab.keys(C.unescape).join("|")+")","g")};ab.each(["escape","unescape"],function(t){ab[t]=function(u){return null==u?"":(""+u).replace(L[t],function(v){return C[t][v]})}}),ab.result=function(w,u){if(null==w){return null}var v=w[u];return ab.isFunction(v)?v.call(w):v},ab.mixin=function(t){X(ab.functions(t),function(u){var v=ab[u]=t[u];ab.prototype[u]=function(){var w=[this._wrapped];return ay.apply(w,arguments),Y.call(this,v.apply(ab,w))}})};var K=0;ab.uniqueId=function(v){var u=""+ ++K;return v?v+u:u},ab.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ah=/(.)^/,W={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;ab.template=function(x,E,v){v=ab.defaults({},v,ab.templateSettings);var z=RegExp([(v.escape||ah).source,(v.interpolate||ah).source,(v.evaluate||ah).source].join("|")+"|$","g"),D=0,y="__p+='";x.replace(z,function(F,I,M,u,N){return y+=x.slice(D,N).replace(V,function(t){return"\\"+W[t]}),I&&(y+="'+\n((__t=("+I+"))==null?'':_.escape(__t))+\n'"),M&&(y+="'+\n((__t=("+M+"))==null?'':__t)+\n'"),u&&(y+="';\n"+u+"\n__p+='"),D=N+F.length,F}),y+="';\n",v.variable||(y="with(obj||{}){\n"+y+"}\n"),y="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+y+"return __p;\n";try{var B=Function(v.variable||"obj","_",y)}catch(w){throw w.source=y,w}if(E){return B(E,ab)}var A=function(t){return B.call(this,t,ab)};return A.source="function("+(v.variable||"obj")+"){\n"+y+"}",A},ab.chain=function(t){return ab(t).chain()};var Y=function(t){return this._chain?ab(t).chain():t};ab.mixin(ab),X(["pop","push","reverse","shift","sort","splice","unshift"],function(v){var u=au[v];ab.prototype[v]=function(){var t=this._wrapped;return u.apply(t,arguments),"shift"!=v&&"splice"!=v||0!==t.length||delete t[0],Y.call(this,t)}}),X(["concat","join","slice"],function(v){var u=au[v];ab.prototype[v]=function(){return Y.call(this,u.apply(this._wrapped,arguments))}}),ab.extend(ab.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);function k(t){return _.chain(_.range(t,10)).reverse().map(function(u){return'g[data-index="'+u+'"]'}).value().join(", ")}function i(u,t){var v=u.getAttribute("class");return((v!==null)?v.replace(/color\d+/g,""):"")+" color"+t}q={getInsertionPoint:k,colorClass:i};var m=this,j=0.25;function e(u,t){return _.chain(u).pluck("data").flatten().pluck(t).uniq().filter(function(v){return v!==undefined&&v!==null}).value().sort(d3.ascending)}function p(w,t,u,x){x=x||j;var v=e(w,t);return d3.scale.ordinal().domain(v).rangeRoundBands(u,x)}function r(v,u,t){return d3.scale.linear().domain(v).nice().rangeRound(u)}function a(v,u,t){return d3.scale.pow().exponent(0.65).domain(v).nice().rangeRound(u)}function g(u,t){return d3.time.scale().domain(_.map(u,function(v){return new Date(v)})).range(t)}function b(w,v){var u=w[0],t=w[1],y,x;if(u===t){x=Math.max(Math.round(u/10),4);u-=x;t+=x}y=t-u;u=(u)?u-(y/10):u;u=(w[0]>0)?Math.max(u,0):u;t=(t)?t+(y/10):t;t=(w[1]<0)?Math.min(t,0):t;return[u,t]}function f(u,y,x,t){var w,v=_.chain(y).pluck("data").flatten().value();w={x:d3.extent(v,function(z){return z.x}),y:d3.extent(v,function(z){return z.y})};_.each([x,t],function(C,A){var B=(A)?"y":"x",z;w[B]=d3.extent(v,function(D){return D[B]});if(C==="ordinal"){return}_.each([B+"Min",B+"Max"],function(D,E){if(C!=="time"){z=b(w[B])}w[B][E]=(u.hasOwnProperty(D)&&u[D]!==null)?u[D]:(C!=="time")?z[E]:w[B][E]})});return w}function d(D,v,y,x){var u=D._options,A=f(u,v,y,x),z={},C=[u.axisPaddingLeft,D._width],w=[D._height,u.axisPaddingTop],B,t;_.each([y,x],function(G,E){var F=(E===0)?"x":"y",H=(E===0)?C:w;switch(G){case"ordinal":z[F]=p(v,F,H);break;case"linear":z[F]=r(A[F],H,F);break;case"exponential":z[F]=a(A[F],H,F);break;case"time":z[F]=g(A[F],H);break}});return z}var o={ordinal:p,linear:r,exponential:a,time:g,xy:d};(function(){var A=2,t="g.bar",w=q.getInsertionPoint(A);function u(C,D,B,E){C.xScale2=d3.scale.ordinal().domain(d3.range(0,B.length)).rangeRoundBands([0,C.xScale.rangeBand()],0.08)}function y(C,I,E,G,F){var H,B,D=C.yZero;H=C._g.selectAll(t+E).data(G,function(J){return J.className});H.enter().insert("g",w).attr("data-index",A).style("opacity",0).attr("class",function(L,K){var J=_.uniq((E+L.className).split(".")).join(" ");return J+" bar "+q.colorClass(this,K)}).attr("transform",function(K,J){return"translate("+C.xScale2(J)+",0)"});B=H.selectAll("rect").data(function(J){return J.data},function(J){return J.x});B.enter().append("rect").attr("width",0).attr("rx",3).attr("ry",3).attr("x",function(J){return C.xScale(J.x)+(C.xScale2.rangeBand()/2)}).attr("height",function(J){return Math.abs(D-C.yScale(J.y))}).attr("y",function(J){return(J.y<0)?D:C.yScale(J.y)}).on("mouseover",F.mouseover).on("mouseout",F.mouseout).on("click",F.click);I.barGroups=H;I.bars=B}function z(B,E,D){var C=B.yZero;E.barGroups.attr("class",function(G,F){return q.colorClass(this,F)}).transition().duration(D).style("opacity",1).attr("transform",function(G,F){return"translate("+B.xScale2(F)+",0)"});E.bars.transition().duration(D).attr("width",B.xScale2.rangeBand()).attr("x",function(F){return B.xScale(F.x)}).attr("height",function(F){return Math.abs(C-B.yScale(F.y))}).attr("y",function(F){return(F.y<0)?C:B.yScale(F.y)})}function v(B,D,C){D.bars.exit().transition().duration(C).attr("width",0).remove();D.barGroups.exit().transition().duration(C).style("opacity",0).remove()}function x(B,E,C){var D=(B.xScale2)?B.xScale2.rangeBand()/2:0;delete B.xScale2;E.bars.transition().duration(C).attr("width",0).attr("x",function(F){return B.xScale(F.x)+D})}n.bar={postUpdateScale:u,enter:y,update:z,exit:v,destroy:x}}());(function(){var z=3,t="g.line",v=q.getInsertionPoint(z);function x(L,E,H,D,F){var C=L._options.interpolation,K=function(P,O){if(!L.xScale2&&!L.xScale.rangeBand){return L.xScale(P.x)}return L.xScale(P.x)+(L.xScale.rangeBand()/2)},I=function(O){return L.yScale(O.y)},N=d3.svg.line().x(K).interpolate(C),B=d3.svg.area().x(K).y1(L.yZero).interpolate(C),A,G,M;function J(O){return[O.data]}A=L._g.selectAll(t+H).data(D,function(O){return O.className});A.enter().insert("g",v).attr("data-index",z).attr("class",function(Q,P){var O=_.uniq((H+Q.className).split(".")).join(" ");return O+" line "+q.colorClass(this,P)});G=A.selectAll("path.fill").data(J);G.enter().append("path").attr("class","fill").style("opacity",0).attr("d",B.y0(I));M=A.selectAll("path.line").data(J);M.enter().append("path").attr("class","line").style("opacity",0).attr("d",N.y(I));E.lineContainers=A;E.lineFills=G;E.linePaths=M;E.lineX=K;E.lineY=I;E.lineA=B;E.line=N}function y(A,C,B){C.lineContainers.attr("class",function(E,D){return q.colorClass(this,D)});C.lineFills.transition().duration(B).style("opacity",1).attr("d",C.lineA.y0(C.lineY));C.linePaths.transition().duration(B).style("opacity",1).attr("d",C.line.y(C.lineY))}function u(A,B){B.linePaths.exit().style("opacity",0).remove();B.lineFills.exit().style("opacity",0).remove();B.lineContainers.exit().remove()}function w(A,C,B){C.linePaths.transition().duration(B).style("opacity",0);C.lineFills.transition().duration(B).style("opacity",0)}n.line={enter:x,update:y,exit:u,destroy:w}}());(function(){var t=n.line;function w(y,D,z,B,A){var C;t.enter(y,D,z,B,A);C=D.lineContainers.selectAll("circle").data(function(E){return E.data},function(E){return E.x});C.enter().append("circle").style("opacity",0).attr("cx",D.lineX).attr("cy",D.lineY).attr("r",5).on("mouseover",A.mouseover).on("mouseout",A.mouseout).on("click",A.click);D.lineCircles=C}function x(y,A,z){t.update.apply(null,_.toArray(arguments));A.lineCircles.transition().duration(z).style("opacity",1).attr("cx",A.lineX).attr("cy",A.lineY)}function u(y,z){z.lineCircles.exit().remove();t.exit.apply(null,_.toArray(arguments))}function v(y,A,z){t.destroy.apply(null,_.toArray(arguments));if(!A.lineCircles){return}A.lineCircles.transition().duration(z).style("opacity",0)}n["line-dotted"]={enter:w,update:x,exit:u,destroy:v}}());(function(){var t=n["line-dotted"];function y(z,D,A,C,B){t.enter(z,D,A,C,B)}function w(A){function B(C,D){return C+D.y}var z=_.map(A,function(E){var C=E.data.length,D=_.clone(E.data);E=_.clone(E);while(C){C-=1;D[C]=_.clone(E.data[C]);D[C].y0=E.data[C].y;D[C].y=_.reduce(_.first(E.data,C),B,E.data[C].y)}return _.extend(E,{data:D})});return z}function x(z){if(!z.hasOwnProperty("cumulativeOMainData")){return}z._mainData=z.cumulativeOMainData;delete z.cumulativeOMainData;z._compData=z.cumulativeOCompData;delete z.cumulativeOCompData}function v(z,A){x(z);z.cumulativeOMainData=z._mainData;z._mainData=w(z._mainData);z.cumulativeOCompData=z._compData;z._compData=w(z._compData)}function u(z,B,A){x(z);t.destroy.apply(null,_.toArray(arguments))}n.cumulative={preUpdateScale:v,enter:y,update:t.update,exit:t.exit,destroy:u}}());var s=[[]],h={mouseover:function(u,t){},mouseout:function(u,t){},click:function(u,t){},axisPaddingTop:0,axisPaddingRight:0,axisPaddingBottom:5,axisPaddingLeft:20,paddingTop:0,paddingRight:0,paddingBottom:20,paddingLeft:60,tickHintX:10,tickWidthX:80,tickFormatX:function(t){return t},tickHintY:10,tickFormatY:function(t){return t},xMin:null,xMax:null,yMin:null,yMax:null,dataFormatX:function(t){return t},dataFormatY:function(t){return t},unsupported:function(t){d3.select(t).text("SVG is not supported on your browser")},empty:function(u,t,v){},notempty:function(u,t){},timing:750,interpolation:"monotone"};function c(){var t=document;return(!!t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)}function l(x,y,t,v){var u=this,w;u._options=v=_.defaults(v||{},h);if(c()===false){return v.unsupported(t)}u._selector=t;u._container=d3.select(t);u._drawSvg();y=_.clone(y);if(x&&!y.type){y.type=x}u.setData(y);d3.select(window).on("resize.for."+t,function(){if(w){clearTimeout(w)}w=setTimeout(function(){w=null;u._resize()},500)})}l.setVis=function(t,u){if(n.hasOwnProperty(t)){throw'Cannot override vis type "'+t+'".'}n[t]=u};l.getVis=function(t){if(!n.hasOwnProperty(t)){throw'Vis type "'+t+'" does not exist.'}return _.clone(n[t])};l.visutils=q;l.scales=o;_.defaults(l.prototype,{setType:function(u,v){var t=this;if(t._type&&u===t._type){return}if(!n.hasOwnProperty(u)){throw'Vis type "'+u+'" is not defined.'}if(t._type){t._destroy(t._vis,t._mainStorage)}t._type=u;t._vis=n[u];if(!v){t._draw()}},setData:function(w){var t=this,x=t._options,u=_.clone(w);if(!w.hasOwnProperty("main")){throw'No "main" key found in given chart data.'}switch(w.type){case"bar":w.xScale="ordinal";break;case undefined:w.type=t._type;break}x.xMin=w.xMin||x.xMin;x.xMax=w.xMax||x.xMax;x.yMin=w.yMin||x.yMin;x.yMax=w.yMax||x.yMax;if(t._vis){t._destroy(t._vis,t._mainStorage)}t.setType(w.type,true);function v(z){var y=_.map(_.clone(z.data),function(B){var A=_.clone(B);if(B.hasOwnProperty("x")){A.x=x.dataFormatX(B.x)}if(B.hasOwnProperty("y")){A.y=x.dataFormatY(B.y)}return A}).sort(function(B,A){if(!B.x&&!A.x){return 0}return(B.x<A.x)?-1:1});return _.extend(_.clone(z),{data:y})}u.main=_.map(u.main,v);t._mainData=u.main;t._xScaleType=u.xScale;t._yScaleType=u.yScale;if(u.hasOwnProperty("comp")){u.comp=_.map(u.comp,v);t._compData=u.comp}else{t._compData=[]}t._draw()},setScale:function(v,u){var t=this;switch(v){case"x":t._xScaleType=u;break;case"y":t._yScaleType=u;break;default:throw'Cannot change scale of unknown axis "'+v+'".'}t._draw()},_drawSvg:function(){var w=this,A=w._container,x=w._options,y=parseInt(A.style("width").replace("px",""),10),t=parseInt(A.style("height").replace("px",""),10),v,z,u;v=A.selectAll("svg").data(s);v.enter().append("svg").attr("height",t).attr("width",y).attr("class","xchart");v.transition().attr("width",y).attr("height",t);z=v.selectAll("g").data(s);z.enter().append("g").attr("transform","translate("+x.paddingLeft+","+x.paddingTop+")");u=z.selectAll("g.scale").data(s);u.enter().append("g").attr("class","scale");w._svg=v;w._g=z;w._gScale=u;w._height=t-x.paddingTop-x.paddingBottom-x.axisPaddingTop-x.axisPaddingBottom;w._width=y-x.paddingLeft-x.paddingRight-x.axisPaddingLeft-x.axisPaddingRight},_resize:function(u){var t=this;t._drawSvg();t._draw()},_drawAxes:function(){if(this._noData){return}var I=this,x=I._options,H=I._gScale.transition().duration(x.timing),z=x.tickHintX,D=x.tickWidthX,E=x.tickHintY,u=I._height+x.axisPaddingTop+x.axisPaddingBottom,C=d3.svg.line().x(function(t){return t}),F,y,w,A,v,G,B;A=d3.svg.axis().scale(I.xScale).ticks(z).tickSize(-I._height).tickFormat(x.tickFormatX).orient("bottom");w=I._gScale.selectAll("g.axisX").data(s);w.enter().append("g").attr("class","axis axisX").attr("transform","translate(0,"+u+")");w.call(A);B=I._gScale.selectAll(".axisX g")[0];if(B.length>(I._width/D)){B.sort(function(J,t){var K=/translate\(([^,)]+)/;J=J.getAttribute("transform").match(K);t=t.getAttribute("transform").match(K);return parseFloat(J[1],10)-parseFloat(t[1],10)});d3.selectAll(B).filter(function(J,t){return t%(Math.ceil(B.length/z)+1)}).remove()}G=d3.svg.axis().scale(I.yScale).ticks(E).tickSize(-I._width-x.axisPaddingRight-x.axisPaddingLeft).tickFormat(x.tickFormatY).orient("left");v=I._gScale.selectAll("g.axisY").data(s);v.enter().append("g").attr("class","axis axisY").attr("transform","translate(0,0)");H.selectAll("g.axisY").call(G);F=I._gScale.selectAll("g.axisZero").data([[]]);F.enter().append("g").attr("class","axisZero");y=F.selectAll("line").data([[]]);y.enter().append("line").attr("x1",0).attr("x2",I._width+x.axisPaddingLeft+x.axisPaddingRight).attr("y1",I.yZero).attr("y2",I.yZero);y.transition().duration(x.timing).attr("y1",I.yZero).attr("y2",I.yZero)},_updateScale:function(){var t=this,w=function(){return _.union(t._mainData,t._compData)},u=w(),x=t._vis,y,v;delete t.xScale;delete t.yScale;delete t.yZero;if(x.hasOwnProperty("preUpdateScale")){x.preUpdateScale(t,u,t._mainData,t._compData)}u=w();y=o.xy(t,u,t._xScaleType,t._yScaleType);t.xScale=y.x;t.yScale=y.y;v=t.yScale.domain()[0];t.yZero=(v>0)?t.yScale(v):t.yScale(0);if(x.hasOwnProperty("postUpdateScale")){x.postUpdateScale(t,u,t._mainData,t._compData)}},_enter:function(x,y,w,u){var t=this,v={click:t._options.click,mouseover:t._options.mouseover,mouseout:t._options.mouseout};t._checkVisMethod(x,"enter");x.enter(t,y,u,w,v)},_update:function(u,v){var t=this;t._checkVisMethod(u,"update");u.update(t,v,t._options.timing)},_exit:function(u,v){var t=this;t._checkVisMethod(u,"exit");u.exit(t,v,t._options.timing)},_destroy:function(u,w){var t=this;t._checkVisMethod(u,"destroy");try{u.destroy(t,w,t._options.timing)}catch(v){}},_mainStorage:{},_compStorage:{},_draw:function(){var u=this,w=u._options,t,v;u._noData=_.flatten(_.pluck(u._mainData,"data").concat(_.pluck(u._compData,"data"))).length===0;u._updateScale();u._drawAxes();u._enter(u._vis,u._mainStorage,u._mainData,".main");u._exit(u._vis,u._mainStorage);u._update(u._vis,u._mainStorage);t=_.chain(u._compData).groupBy(function(x){return x.type});v=t.keys();_.each(u._compStorage,function(z,x){if(-1===v.indexOf(x).value()){var y=n[x];u._enter(y,z,[],".comp."+x.replace(/\W+/g,""));u._exit(y,z)}});t.each(function(z,x){var y=n[x],A;if(!u._compStorage.hasOwnProperty(x)){u._compStorage[x]={}}A=u._compStorage[x];u._enter(y,A,z,".comp."+x.replace(/\W+/g,""));u._exit(y,A);u._update(y,A)});if(u._noData){w.empty(u,u._selector,u._mainData)}else{w.notempty(u,u._selector)}},_checkVisMethod:function(u,v){var t=this;if(!u[v]){throw'Required method "'+v+'" not found on vis type "'+t._type+'".'}}});if(typeof define==="function"&&define.amd&&typeof define.amd==="object"){define(function(){return l});return}window.xChart=l}());